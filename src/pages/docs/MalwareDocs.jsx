import { Bug, Cpu, FileText, Zap, AlertTriangle, CheckCircle, Shield } from 'lucide-react'

const Section = ({ title, icon: Icon, children }) => (
    <div className="mb-12">
        <div className="flex items-center gap-3 mb-4">
            <div className="p-2 rounded-lg bg-red-500/10 text-red-500">
                <Icon size={20} />
            </div>
            <h2 className="text-2xl font-bold text-white">{title}</h2>
        </div>
        <div className="prose prose-invert prose-p:text-foreground/70 prose-headings:text-white max-w-none">
            {children}
        </div>
    </div>
)

export default function MalwareDocs() {
    return (
        <div className="space-y-8">
            <div className="border-b border-white/10 pb-8">
                <div className="inline-block px-3 py-1 bg-red-500/10 text-red-500 rounded-full text-xs font-mono mb-4">
                    DANGEROUS ENVIRONMENTS
                </div>
                <h1 className="text-4xl font-bold text-white mb-4">Malware Analysis Documentation</h1>
                <p className="text-xl text-foreground/60">
                    Complete guide to static and dynamic analysis of suspicious binaries using the IntelX Sandbox environment. Safely analyze malware, trojans, and suspicious executables without risking your system.
                </p>
            </div>

            <Section title="What is Malware Analysis?" icon={Bug}>
                <p>
                    Malware Analysis is the process of investigating a suspicious file or program to understand its behavior, capabilities, and potential threat level. IntelX provides a secure, isolated environment where you can analyze:
                </p>
                <ul className="list-disc pl-5 mt-3 space-y-2 text-foreground/70">
                    <li><strong>Executables:</strong> EXE, ELF, Mach-O binaries and shared libraries</li>
                    <li><strong>Ransomware:</strong> Identify encryption, key management, and payload delivery</li>
                    <li><strong>Trojan Horses:</strong> Detect command-and-control (C2) infrastructure and backdoors</li>
                    <li><strong>Worms & Viruses:</strong> Analyze replication mechanisms and attack vectors</li>
                    <li><strong>Rootkits:</strong> Uncover system-level persistence techniques</li>
                    <li><strong>Spyware & Keyloggers:</strong> Identify data exfiltration methods</li>
                </ul>
                <div className="p-4 bg-red-500/10 border border-red-500/20 rounded-lg my-6 mt-6">
                    <div className="flex items-start gap-3">
                        <AlertTriangle className="text-red-400 mt-1 shrink-0" size={18} />
                        <div className="text-sm text-red-300">
                            <strong>‚ö†Ô∏è Safety Warning:</strong> All analysis is conducted in an isolated, air-gapped virtual sandbox. The malware cannot access your system, network, or data. Never download or execute malware samples on your local machine.
                        </div>
                    </div>
                </div>
            </Section>

            <Section title="Analysis Pipeline" icon={Zap}>
                <h3 className="text-xl font-bold text-white mt-4 mb-3">Stage 1: File Validation & Hashing</h3>
                <p>
                    When you upload a file, IntelX immediately computes cryptographic hashes:
                </p>
                <ul className="list-disc pl-5 mt-2 space-y-1 text-foreground/70">
                    <li><strong>MD5:</strong> 128-bit hash (fast, used for quick lookups)</li>
                    <li><strong>SHA-256:</strong> 256-bit cryptographic hash (collision-resistant)</li>
                    <li><strong>File Type Detection:</strong> Magic bytes and file structure analysis</li>
                    <li><strong>Size & Entropy:</strong> Compression/encryption detection</li>
                </ul>
                <p className="mt-3 text-foreground/70">
                    These hashes are checked against threat intelligence databases like VirusTotal, URLhaus, and MISP to see if the file has been previously analyzed and flagged.
                </p>

                <h3 className="text-xl font-bold text-white mt-6 mb-3">Stage 2: Static Analysis & Decompilation</h3>
                <p>
                    Static analysis examines the binary without executing it:
                </p>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4 my-4">
                    <div className="p-4 bg-[#0a0e17] rounded-lg border border-white/10">
                        <h4 className="font-bold text-neon-green mb-2">ELF Header Analysis</h4>
                        <p className="text-sm text-foreground/70">Examines binary structure, linked libraries, entry points, and relocation tables to understand code organization.</p>
                    </div>
                    <div className="p-4 bg-[#0a0e17] rounded-lg border border-white/10">
                        <h4 className="font-bold text-neon-green mb-2">Disassembly</h4>
                        <p className="text-sm text-foreground/70">Converts machine code to human-readable assembly language using tools like objdump and Capstone engine.</p>
                    </div>
                    <div className="p-4 bg-[#0a0e17] rounded-lg border border-white/10">
                        <h4 className="font-bold text-neon-green mb-2">Decompilation</h4>
                        <p className="text-sm text-foreground/70">Reconstructs high-level pseudocode (C-like syntax) from assembly using advanced decompilers like Ghidra.</p>
                    </div>
                    <div className="p-4 bg-[#0a0e17] rounded-lg border border-white/10">
                        <h4 className="font-bold text-neon-green mb-2">String Extraction</h4>
                        <p className="text-sm text-foreground/70">Pulls hardcoded strings, URLs, and file paths that reveal the malware's behavior and targets.</p>
                    </div>
                </div>

                <h3 className="text-xl font-bold text-white mt-6 mb-3">Stage 3: Dynamic Analysis (Sandbox Execution)</h3>
                <p>
                    The binary is executed in a controlled sandbox environment where all system calls are monitored:
                </p>
                <ul className="list-disc pl-5 mt-2 space-y-1 text-foreground/70">
                    <li><strong>File Operations:</strong> What files are created, modified, or deleted</li>
                    <li><strong>Registry Changes:</strong> Windows registry modifications for persistence</li>
                    <li><strong>Network Activity:</strong> DNS queries, HTTP requests, C2 connections</li>
                    <li><strong>Process Behavior:</strong> Child processes spawned, inter-process communication</li>
                    <li><strong>API Calls:</strong> Windows/Linux API calls indicating malicious intent</li>
                    <li><strong>Memory Injection:</strong> DLL injection, code caves, process hollowing</li>
                </ul>

                <h3 className="text-xl font-bold text-white mt-6 mb-3">Stage 4: Threat Intelligence & Reporting</h3>
                <p>
                    The analyzer correlates findings against threat databases and generates actionable intelligence:
                </p>
                <ul className="list-disc pl-5 mt-2 space-y-1 text-foreground/70">
                    <li>Threat classification (ransomware, trojan, spyware, PUP, benign)</li>
                    <li>MITRE ATT&CK framework mapping of techniques and tactics</li>
                    <li>IOC (Indicators of Compromise) extraction</li>
                    <li>Related samples and campaign attribution</li>
                </ul>
            </Section>

            <Section title="AI-Powered Code Analysis" icon={Cpu}>
                <h3 className="text-xl font-bold text-white mt-4 mb-3">Automatic Threat Summary</h3>
                <p>
                    IntelX integrates advanced machine learning models to analyze decompiled code and provide human-readable threat assessments:
                </p>
                <div className="my-6 p-5 bg-[#0a0e17] border-l-4 border-neon-green rounded-r-lg">
                    <h4 className="font-bold text-white mb-2">‚úì What the AI Summary Includes</h4>
                    <ul className="list-disc pl-5 space-y-1 text-sm text-foreground/70 mt-2">
                        <li><strong>Behavioral Description:</strong> High-level explanation of what the malware does</li>
                        <li><strong>Suspicious Functions:</strong> Flagged system calls (e.g., CreateRemoteThread, SetWindowsHookEx)</li>
                        <li><strong>Attack Methods:</strong> Identified exploitation techniques and tactics</li>
                        <li><strong>Data Theft Indicators:</strong> Password stealing, credential dumping, file exfiltration</li>
                        <li><strong>Persistence Mechanisms:</strong> Registry run keys, scheduled tasks, DLL hijacking</li>
                        <li><strong>Threat Score:</strong> Numeric risk assessment from 0 (benign) to 10 (critical)</li>
                    </ul>
                </div>

                <h3 className="text-xl font-bold text-white mt-6 mb-3">Execution Flow Diagrams</h3>
                <p>
                    The Flow Diagram feature generates a visual representation of the malware's execution path:
                </p>
                <div className="my-6 p-5 bg-[#0a0e17] border-l-4 border-neon-yellow rounded-r-lg">
                    <h4 className="font-bold text-white mb-2">üìä How Flow Diagrams Work</h4>
                    <ul className="list-disc pl-5 space-y-1 text-sm text-foreground/70 mt-2">
                        <li>Entry point (main function or DLL entry) is shown</li>
                        <li>Control flow nodes show function calls and decision points</li>
                        <li>Node colors indicate threat level (green=benign, yellow=suspicious, red=malicious)</li>
                        <li>Arrows show data flow and function invocation order</li>
                        <li>Helps identify critical code paths and attack chains</li>
                    </ul>
                </div>
            </Section>

            <Section title="File Upload & Requirements" icon={Shield}>
                <h3 className="text-xl font-bold text-white mt-4 mb-3">Supported File Types</h3>
                <p>
                    IntelX supports analysis of binary executables and compiled code:
                </p>
                <div className="grid grid-cols-2 md:grid-cols-3 gap-3 my-4">
                    {['EXE', 'DLL', 'ELF', 'SO', 'BIN', 'O', 'OUT'].map((ext, i) => (
                        <div key={i} className="p-3 rounded-lg bg-red-500/10 border border-red-500/20 text-center">
                            <span className="text-sm font-mono font-bold text-red-400">.{ext}</span>
                        </div>
                    ))}
                </div>

                <h3 className="text-xl font-bold text-white mt-6 mb-3">File Size & Processing Time</h3>
                <ul className="list-disc pl-5 space-y-1 text-foreground/70">
                    <li><strong>Max Size:</strong> 100 MB (larger files are skipped for sandbox stability)</li>
                    <li><strong>Processing Time:</strong> 30 seconds to 5 minutes depending on file size and complexity</li>
                    <li><strong>Timeout:</strong> Analysis is halted after 5 minutes to prevent infinite loops</li>
                    <li><strong>Queue:</strong> During peak times, your analysis may wait 1-10 minutes in the queue</li>
                </ul>

                <h3 className="text-xl font-bold text-white mt-6 mb-3">Privacy & Data Handling</h3>
                <div className="p-4 bg-blue-500/10 border border-blue-500/20 rounded-lg my-4">
                    <h4 className="font-bold text-blue-400 mb-2">üîí Your Privacy is Protected</h4>
                    <ul className="list-disc pl-5 space-y-1 text-sm text-blue-200 mt-2">
                        <li>Uploaded files are isolated in encrypted sandboxes</li>
                        <li>Analysis results may be added to threat intelligence databases (anonymized)</li>
                        <li>Files are deleted after 30 days of inactivity</li>
                        <li>Private account option available for sensitive samples</li>
                    </ul>
                </div>
            </Section>

            <Section title="Interpreting Results" icon={FileText}>
                <h3 className="text-xl font-bold text-white mt-4 mb-3">Threat Level Indicators</h3>
                <div className="space-y-3 my-4">
                    <div className="p-4 bg-red-500/10 border border-red-500/20 rounded-lg">
                        <h4 className="font-bold text-red-400 mb-1">üî¥ MALICIOUS (8-10/10)</h4>
                        <p className="text-sm text-red-200">Clear indicators of harmful intent: data theft, ransomware behavior, worm replication, rootkit installation</p>
                    </div>
                    <div className="p-4 bg-yellow-500/10 border border-yellow-500/20 rounded-lg">
                        <h4 className="font-bold text-yellow-400 mb-1">üü° SUSPICIOUS (4-7/10)</h4>
                        <p className="text-sm text-yellow-200">Unusual but not conclusively malicious: obfuscation, process injection, suspicious API calls</p>
                    </div>
                    <div className="p-4 bg-green-500/10 border border-green-500/20 rounded-lg">
                        <h4 className="font-bold text-green-400 mb-1">üü¢ BENIGN (0-3/10)</h4>
                        <p className="text-sm text-green-200">Legitimate software: no suspicious behavior, recognized from trust databases</p>
                    </div>
                </div>

                <h3 className="text-xl font-bold text-white mt-6 mb-3">Threat Intelligence Dashboard</h3>
                <p>
                    The main results panel shows an at-a-glance threat assessment:
                </p>
                <ul className="list-disc pl-5 mt-2 space-y-1 text-foreground/70">
                    <li><strong>Malicious/Suspicious/Harmless Ratios:</strong> Detections from antivirus engines</li>
                    <li><strong>SHA256/MD5 Hashes:</strong> Unique file identifiers for lookups</li>
                    <li><strong>File Type & Size:</strong> Binary format information</li>
                    <li><strong>MITRE ATT&CK Mappings:</strong> Techniques and tactics used by the malware</li>
                </ul>

                <h3 className="text-xl font-bold text-white mt-6 mb-3">PDF Report Generation</h3>
                <p>
                    The "Download Report" button generates a professional PDF containing:
                </p>
                <ul className="list-disc pl-5 mt-2 space-y-1 text-foreground/70">
                    <li>Executive summary with threat level and confidence scores</li>
                    <li>File metadata and cryptographic hashes</li>
                    <li>Decompiled code snippets (first 1000 lines)</li>
                    <li>AI analysis summary in markdown format</li>
                    <li>Threat indicators and IOCs</li>
                    <li>Recommendations and remediation steps</li>
                </ul>
            </Section>

            <Section title="Common Malware Types" icon={AlertTriangle}>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4 my-4">
                    <div className="p-4 bg-[#0a0e17] rounded-lg border border-white/10">
                        <h4 className="font-bold text-neon-green mb-2">üîí Ransomware</h4>
                        <p className="text-sm text-foreground/70 mb-2">Encrypts victim's files and demands payment. Look for: encryption libraries, key generation, file iteration loops, ransom note creation.</p>
                    </div>
                    <div className="p-4 bg-[#0a0e17] rounded-lg border border-white/10">
                        <h4 className="font-bold text-neon-green mb-2">üï∑Ô∏è Trojan</h4>
                        <p className="text-sm text-foreground/70 mb-2">Appears benign but contains hidden malicious payload. Look for: C2 servers, remote command execution, hidden network sockets.</p>
                    </div>
                    <div className="p-4 bg-[#0a0e17] rounded-lg border border-white/10">
                        <h4 className="font-bold text-neon-green mb-2">üêõ Worm</h4>
                        <p className="text-sm text-foreground/70 mb-2">Self-replicating malware that spreads via networks. Look for: network scanning, SMB exploitation, USB propagation, email sending.</p>
                    </div>
                    <div className="p-4 bg-[#0a0e17] rounded-lg border border-white/10">
                        <h4 className="font-bold text-neon-green mb-2">üëÅÔ∏è Spyware</h4>
                        <p className="text-sm text-foreground/70 mb-2">Steals user data and monitors activity. Look for: keylogging, clipboard access, browser history, password stealing, screen capture.</p>
                    </div>
                    <div className="p-4 bg-[#0a0e17] rounded-lg border border-white/10">
                        <h4 className="font-bold text-neon-green mb-2">üîë Rootkit</h4>
                        <p className="text-sm text-foreground/70 mb-2">Achieves kernel-level access for deep system compromise. Look for: kernel driver loading, system call hooking, registry manipulation.</p>
                    </div>
                    <div className="p-4 bg-[#0a0e17] rounded-lg border border-white/10">
                        <h4 className="font-bold text-neon-green mb-2">üì± PUP</h4>
                        <p className="text-sm text-foreground/70 mb-2">Potentially Unwanted Programs that bundle with legitimate software. Look for: advertising injection, search hijacking, performance degradation.</p>
                    </div>
                </div>
            </Section>
        </div>
    )
}
